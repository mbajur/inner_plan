<% groups = list.groups.ordered_by_position %>

<div data-tasks-tree-target="list" data-update-url="<%= update_position_list_path(list) %>" data-id="<%= list.id %>" class="mb-5">
  <div class="d-flex w-100 mb-1">
    <div class="align-top me-2 text-body-tertiary list-handle" style="margin-top:1.5rem">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" width="20" height="20" stroke-width="2">
        <path d="M9 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
        <path d="M9 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
        <path d="M9 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
        <path d="M15 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
        <path d="M15 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
        <path d="M15 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"></path>
      </svg>
    </div>

    <div class="ms-1 w-100">
      <small class="text-body-tertiary">
        <%= list.tasks.completed.count %>/<%= list.tasks.count %> completed
      </small>

      <h3 class="h5">
        <%= link_to list.title, list, class: 'text-reset' %>
      </h3>

      <% if list.description.present? %>
        <div class="mb-2">
          <%= list.description %>
        </div>
      <% end %>
    </div>
  </div>

  <div data-tasks-tree-target="groupsContainer">
    <% groups.each_with_index do |group, index| %>
      <%= render partial: 'inner_plan/groups/group', locals: { group: group, context: context } %>
    <% end %>
  </div>

  <div class="mt-2 mb-4">
    <% last_group = groups.to_a.last %>
    <turbo-frame id="<%= dom_id(last_group, :add_task) %>">
      <a href="<%= new_group_task_path(last_group) %>" class="btn btn-outline-secondary btn-sm ms-tasks-element">
        Add a to-do
      </a>
    </turbo-frame>
  </div>

  <div class="mt-3">
    <%= render partial: 'inner_plan/tasks/completed_tasks', locals: { list: list, context: local_assigns[:context], truncate: true } %>
  </div>
</div>
